---
title: "Data Analysis Report"
author: "Team 9"
date: "2024-10-11"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = TRUE)
```

```{r include=FALSE}
# Load Packages
library(readr)
library(ggplot2)
library(dplyr)
library(broom)
library(knitr)
library(kableExtra)
library(car)
```

```{r include=FALSE}
# Importing Data Set
cleaned_data <- read_csv("../../output/IMDb_dt.csv")
```


```{r include=FALSE}
# Cleaning The Data
cleaned_data <- cleaned_data %>%
  rename(average_rating = 'The average rating') %>%
  rename(Number_of_episodes = 'Number of episodes') %>%
  filter(!is.na(Number_of_episodes), !is.na(average_rating))
```


## 1. Summary of Descriptive Statistics on Average Ratings

In this section, we present a summary of the descriptive statistics for the average ratings of TV shows. This analysis provides an overview of key metrics such as the mean, median, standard deviation, and range of ratings.


```{r echo=FALSE}
Descriptive_stats <- cleaned_data %>% 
  summarize(
  mean_average_rating = mean(average_rating, na.rm = TRUE),
  median_rating = median(average_rating, na.rm = TRUE),
  min_rating = min(average_rating, na.rm = TRUE),
  max_rating = max(average_rating, na.rm = TRUE),
  num_episodes = n()
)

kable(Descriptive_stats)
```

# 2. Regressing Rating on Number of Episode

For this analysis, we decided to use regression analysis to explore the relationship between the number of episodes and the ratings of TV shows. By applying this method, we aim to determine whether the number of episodes significantly impacts a show's rating and to quantify the strength of this relationship. This approach will help us gain insights into how episode count influences audience engagement and reception.

### 2.1 Main Model Without Control Variables

```{r echo=FALSE}
basic_model <- lm(average_rating ~ Number_of_episodes, data = cleaned_data)

tidy_model <- tidy(basic_model)

kable(tidy_model, caption = "Model Summary: Number of Episodes on Average Rating") %>%
  kable_styling(full_width = F)  

## Plot of Basic Model without Control Variables
ggplot(cleaned_data, aes(x = Number_of_episodes, y = average_rating)) +
  geom_point() + geom_smooth(method = "lm") + labs(
    title = "Regression of Average Ratings over The number of episodes",
    x = "Number of episodes",
    y = "Average Rating"
  )
```

### 2.2 Regression Analysis Output
* Coefficient for Number of episodes: -0.6819 x 10^-5
* T-value for Number of episodes: -24.62
* P-value for Number of episodes: <2.2 x 10^-16
* R-squared: 0.0008274

In our basic model without any control variables, we can see that the number of episodes have a slightly negative effect on the average IMDb rating.
With a P-value smaller than significance level of 5%, we can conclude that the number of episodes has a negative effect.
However this model is without any control variables, so we need to expand our model.

### 2.3 Main Model With Control Variables
```{r echo=FALSE}
main_model <- lm(average_rating ~ Number_of_episodes + popularity + runtime + new_vs_old + episode_quantity , data = cleaned_data)

tidy_model <- tidy(main_model)

kable(tidy_model, caption = "Model Summary: Number of Episodes on Average Rating") %>%
  kable_styling(full_width = F)  
```

#### Control Variable Definition:
* popularity: "Amount of votes are over 1000
* runtime: "Runtime in minutes is more than 50"
* new_vs_old: "The start year is later than 2015"
* episode_quantity: "Number of episodes is more than 25"


### 2.4 Regression Analysis Output:
* Coefficient for Number of episodes: -1.183 x 10^-6
* T-value for Number of episodes: -0.355
* P-value for Number of episodes: 0.722
* R-squared 0.0376

In our main model with control variables, we observe that the coefficient for the number of episodes is negative; however, it is not significant, as the p-value for this variable is 0.772, which is greater than 0.05. Looking at our control variables, we find that all of them are significant: Popularity (amount of votes over 1000) has a significant positive effect on the average rating. In contrast, runtime (runtime in minutes is more than 50) has a significant negative effect on the average rating. Additionally, being new (the start year is later than 2015) has a significant negative effect on the average rating, and having many episodes (more than 25 episodes) also negatively affects the average rating.


## 3. Correlation Matrix of the Predictive Variables in our Main Model 
```{r echo=FALSE}
main_model_corr<- lm(average_rating ~ Number_of_episodes + popularity + runtime + new_vs_old + episode_quantity , data = cleaned_data)
correlation_matrix <- cor(model.matrix(main_model)[, -1])
correlation_df <- as.data.frame(correlation_matrix)

knitr::kable(correlation_df)
```

### Correlation Matrix Analysis:

* Number of episodes has a moderate positive correlation (0.217) with episode quantityMany, indicating that shows with many episodes tend to be classified as having "many" episodes.
* Number of episodes has weak correlations with other variables like popularity (-0.017), runtime (0.022), and new vs old (-0.040), suggesting that the number of episodes is not strongly related to these variables.
* Popularity is weakly and negatively correlated with both new vs old (-0.039) and episode quantityMany (-0.061), indicating that neither older shows nor those with many episodes are strongly related to popularity.
* Runtime has a weak positive correlation (0.049) with new vs old, meaning that older shows may have slightly longer runtimes.

Overall, the relationships between most variables are weak, indicating little to no strong linear correlation between them.The only meaningful correlation is between Number of episodes and episode quantityMany (0.217), which makes sense as it reflects the classification of episode quantity.

## 4. Multicollinearity
```{r echo=FALSE}
main_model_multi <- lm(average_rating ~ Number_of_episodes + popularity + runtime + new_vs_old + episode_quantity , data = cleaned_data)
vif_values <- vif(main_model)
vif_df <- as.data.frame(vif_values)
colnames(vif_df) <- c("VIF")

knitr::kable(vif_df)
```
### Multicollinearity Analysis:
All VIF values are close to 1, indicating that there is no significant multicollinearity among the variables. This suggests that each variable provides unique information to the model, and none of them are overly redundant.

